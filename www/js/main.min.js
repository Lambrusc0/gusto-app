function pos(){var e=localStorage.getItem("user_name"),t=localStorage.getItem("user-position"),o=localStorage.getItem("access"),a=(localStorage.getItem("user_id"),0);$("#name").html(e),$("#position").html(t),2==o&&$("#top-menu").append("<input type='button' class='red' value='CLOSE DAY' id='close-day'>"),db.transaction(function(e){e.executeSql("SELECT rowid, * FROM open_table WHERE open = 1 ",[],function(e,t){var o,l=t.rows.length;for($("#open-tables").html(l),o=0;o<l;o++){var n=t.rows.item(o).rowid,r=t.rows.item(o).customer_number,i=t.rows.item(o).table_number;t.rows.item(o).user_id;a+=r,$("#customers").html(a);var c=$('<input class="green" type="button" value="'+i+'" id="'+n+'">');$("#tables").append(c)}},null)}),$("#number-board").on("click","input[type=button]",function(){"back"==(TableNumber=$(this).attr("id"))?TableCode.pop():TableCode.push(TableNumber),console.log(TableCode),""!==(TableCodeJoin=TableCode.join(""))?$("#code-display").html(TableCodeJoin):$("#code-display").html("Table Number"),$("#number-board-display").html(TableCodeJoin)})}function summary(){var e=0;db.transaction(function(t){t.executeSql('SELECT strftime("%d-%m-%Y",open_date) AS formatted_timestamp FROM open_table WHERE rowid = 1 ',[],function(e,t){var o,a=t.rows.length;for(o=0;o<a;o++)dateTime=t.rows.item(o).formatted_timestamp,console.log(dateTime),$("#sum-date").html(dateTime)},null),t.executeSql("SELECT customer_number FROM open_table",[],function(t,o){var a,l=o.rows.length,n=0;for(a=0;a<l;a++)n=o.rows.item(a).customer_number,e+=n,console.log(e);$("#sum-customers").html(e),$("#customer-numbers").val(e),$("#sum-tables").html(l),$("#table-numbers").val(l)},null),t.executeSql("SELECT total, subtotal, service_charge FROM open_table",[],function(e,t){var o,a=t.rows.length,l=0,n=0,r=0;for(o=0;o<a;o++)l=t.rows.item(o).total,n=t.rows.item(o).subtotal,r=t.rows.item(o).service_charge,total+=l,subtotal+=n,serviceCharge+=r;total=total.toFixed(2),subtotal=subtotal.toFixed(2),serviceCharge=serviceCharge.toFixed(2),console.log(total),$("#sum-total").html("£"+total),$("#sum-subtotal").html("£"+subtotal),$("#sum-service-charge").html("£"+serviceCharge)},null),t.executeSql("SELECT total, payment FROM open_table",[],function(e,t){var o,a=t.rows.length,l=0,n=0,r=0,i="";for(o=0;o<a;o++)i=t.rows.item(o).payment,console.log(i),"cash"===i?(l=t.rows.item(o).total,cash+=l):"amex"===i?(n=t.rows.item(o).total,amex+=n):"card"===i&&(r=t.rows.item(o).total,otherCard+=r);$("#sum-cash").html("£"+cash),$("#sum-amex").html("£"+amex),$("#sum-other").html("£"+otherCard)},null)},null)}function openTable(){$("#close-day").hide();var e=localStorage.getItem("table-id"),t=localStorage.getItem("user_name"),o=localStorage.getItem("user-position");localStorage.getItem("access"),localStorage.getItem("user_id");$("#name").html(t),$("#position").html(o),$("#total-input").val(0),$("#subtotal-input").val(0),$("#number-board").on("click","input[type=button]",function(){"back"==(TableNumber=$(this).attr("id"))?TableCode.pop():TableCode.push(TableNumber),console.log(TableCode),""!==(TableCodeJoin=TableCode.join(""))?$("#code-display").html(TableCodeJoin):$("#code-display").html("Table Number"),$("#number-board-display").html(TableCodeJoin)}),db.transaction(function(t){var o=0,a=0;t.executeSql("SELECT rowid, * FROM open_table WHERE table_number = "+e+" AND open = 1 ",[],function(t,l){var n,r=l.rows.length;for(n=0;n<r;n++){var i=l.rows.item(n).rowid,c=l.rows.item(n).customer_number,s=l.rows.item(n).table_number;l.rows.item(n).user_id;localStorage.setItem("table-rowid",i),$("#table-number").html(s),$("#customers").html(c)}console.log(i+" "+e),t.executeSql("SELECT rowid, * FROM order_item WHERE table_id = "+e+" AND table_rowid = "+i+" ",[],function(e,t){var l,n=t.rows.length;for(console.log(n),l=0;l<n;l++){var r=t.rows.item(l).rowid,i=t.rows.item(l).item_name,c=t.rows.item(l).item_price;t.rows.item(l).sent;console.log(i+" "+c),o+=c,$("#subtotal-input").val(o),$("#subtotal-price").html("£"+o.toFixed(2));var s="<tr id='"+r+"'><td>1</td><td style='text-align:left;'>"+i+"</td><td style='text-align:right;'>"+c+"</td><td>*</td></tr>";$(" #item-table ").append(s)}e.executeSql("SELECT * FROM SETTINGS",[],function(e,t){var l=t.rows.item(0).service_charge,n=(l/100*o).toFixed(2),r=t.rows.item(0).message,i=t.rows.item(0).phone,c=t.rows.item(0).VAT_number,s=t.rows.item(0).company;$("#message").html(r),$("#phone").html("+"+i),$("#vat-number").html(c),$("#restaurant-name").html(s),$("#service-charge-input").val(l),console.log(n),$("#service-charge").html("£"+n),a=(a=+n+ +o).toFixed(2),$("#total-input").val(a),console.log(a),$("#total").html("£"+a)})},null)},null),t.executeSql("SELECT rowid, * FROM category",[],function(e,t){var o,a=t.rows.length;for(o=0;o<a;o++){var l=t.rows.item(o).rowid,n=t.rows.item(o).category_id,r=t.rows.item(o).category_name,i=$('<input type="button" class="green" value="'+r+'" id="'+l+'"/>');$(i).insertBefore("#cancel-order");var c=$('<div id="c'+l+'" class="hide"></div>');$("#right-menu-wrap").append(c),e.executeSql("SELECT * FROM item WHERE category_id = "+n+" ",[],function(e,t){var a,l=t.rows.length;for(a=0;a<l;a++){var n=t.rows.item(a).item_name,r=t.rows.item(a).item_id,i=(t.rows.item(a).item_description,t.rows.item(o).category_id),c=$('<input class="blue hide" type="button" value="'+n+'" id="'+r+'">');$("#c"+i).append(c)}$("#c1").removeClass("hide"),$("#c1").children().removeClass("hide")})}},null)})}var db=openDatabase("gusto_db","1.0","Gusto DB",2097152);document.addEventListener("gesturestart",function(e){e.preventDefault()}),$("#login").click(function(){event.preventDefault();var e=document.forms["login-form"]["user-name"].value,t=document.forms["login-form"]["company-id"].value,o=document.forms["login-form"].password.value;localStorage.setItem("uname",e),localStorage.setItem("companyId",t),localStorage.setItem("password",o);var a="uname="+e+"&companyId="+t+"&password="+o;""==t||""==e||""==o?document.getElementById("error").innerHTML="Please fill all fields":$.ajax({url:"https://gaborjuhasz.co.uk/gusto-connection/login.php",data:a,crossDomain:!0,type:"POST",cache:!1,beforeSend:function(){$("#login").val("Checking...")},success:function(e){if(db.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS category (category_id unique, category_name text)"),e.executeSql("CREATE TABLE IF NOT EXISTS user (user_id unique, user_name text, access integer, user_position text, app_code integer)"),e.executeSql("CREATE TABLE IF NOT EXISTS item (item_id unique, category_id integer,item_name text, item_price decimal(5,2), item_description text)"),e.executeSql("CREATE TABLE IF NOT EXISTS settings (VAT_number integer, service_charge decimal(4,2), phone integer, message text, company TEXT)")}),0==e)$("#error").html("User data was not found");else{var t=(e=$.parseJSON(e))[Object.keys(e)[0]],o=e[Object.keys(e)[1]],a=e[Object.keys(e)[2]],l=e[Object.keys(e)[3]],n=e[Object.keys(e)[4]];console.log(l),db.transaction(function(e){for(var r=0;r<t.length;r++)for(var i=t[r],c=0;c<i.length;c++){var s=i[c].category_id,m=i[c].category_name;e.executeSql("INSERT INTO category (category_id, category_name) VALUES ("+s+', "'+m+'")')}for(var u=0;u<o.length;u++)for(var d=o[u],b=0;b<d.length;b++){var p=d[b].user_name,g=d[b].user_id,h=d[b].access,T=d[b].app_code,E=d[b].user_position;e.executeSql("INSERT INTO user (user_id , user_name , access , user_position , app_code ) VALUES ("+g+',"'+p+'",'+h+',"'+E+'",'+T+")")}for(var _=0;_<a.length;_++)for(var S=a[_],v=0;v<S.length;v++){var w=S[v].item_id,f=S[v].item_name,$=S[v].item_price,s=S[v].category_id,I=S[v].item_description;e.executeSql("INSERT INTO item (item_id, category_id, item_name, item_price, item_description) VALUES ("+w+", "+s+', "'+f+'", '+$+', "'+I+'")')}for(var x=0;x<l.length;x++)for(var S=l[x],y=0;y<S.length;y++){var C=S[y].VAT_number,N=S[y].service_charge,R=S[y].phone,A=S[y].message;console.log(w+" "+f+" "+$+" "+s+" "+I),e.executeSql("INSERT INTO settings (VAT_number, service_charge, phone, message) VALUES ("+C+", "+N+", "+R+', "'+A+'")')}for(var O=0;O<n.length;O++)for(var S=n[O],L=0;L<S.length;L++){var q=S[L].company_name;console.log(q),e.executeSql("UPDATE settings SET company = "+q+" WHERE ")}}),window.location.replace("application.html")}}})});var code=[],codeJoin="";$("#keyboard").on("click","input[type=button]",function(){var e=$(this).attr("id");if("back"==e)code.pop();else if("delete"==e)code=[];else if("enter"==e)db.transaction(function(e){e.executeSql("SELECT * FROM user WHERE app_code="+codeJoin+" ",[],function(e,t){var o=t.rows.length;if(1===o){for(var a=0;a<o;a++)var l=t.rows.item(a).user_name,n=t.rows.item(a).user_id,r=t.rows.item(a).access,i=t.rows.item(a).user_position;localStorage.setItem("user_id",n),localStorage.setItem("user_name",l),localStorage.setItem("user-position",i),localStorage.setItem("access",r),window.location.replace("pos.html")}else $("#code-display").html("Wrong user code"),code=[]},null)});else if("refresh"==e){db.transaction(function(e){e.executeSql("DROP TABLE category"),e.executeSql("DROP TABLE item"),e.executeSql("DROP TABLE user"),e.executeSql("DROP TABLE settings")});var t="uname="+localStorage.getItem("uname")+"&companyId="+localStorage.getItem("companyId")+"&password="+localStorage.getItem("password");$.ajax({url:"https://gaborjuhasz.co.uk/gusto-connection/login.php",data:t,crossDomain:!0,type:"POST",cache:!1,beforeSend:function(){$("#enter").val("DATA IS REFRESHED...")},success:function(e){if(db.transaction(function(e){e.executeSql("CREATE TABLE IF NOT EXISTS category (category_id unique, category_name text)"),e.executeSql("CREATE TABLE IF NOT EXISTS user (user_id unique, user_name text, access integer, user_position text, app_code integer)"),e.executeSql("CREATE TABLE IF NOT EXISTS item (item_id unique, category_id integer,item_name text, item_price decimal(5,2), item_description text)"),e.executeSql("CREATE TABLE IF NOT EXISTS settings (VAT_number integer, service_charge decimal(4,2), phone integer, message text, company text)")}),0==e)$("#error").html("User data was not found");else{var t=(e=$.parseJSON(e))[Object.keys(e)[0]],o=e[Object.keys(e)[1]],a=e[Object.keys(e)[2]],l=e[Object.keys(e)[3]],n=e[Object.keys(e)[4]];console.log(l),db.transaction(function(e){for(var r=0;r<t.length;r++)for(var i=t[r],c=0;c<i.length;c++){var s=i[c].category_id,m=i[c].category_name;e.executeSql("INSERT INTO category (category_id, category_name) VALUES ("+s+', "'+m+'")')}for(var u=0;u<o.length;u++)for(var d=o[u],b=0;b<d.length;b++){var p=d[b].user_name,g=d[b].user_id,h=d[b].access,T=d[b].app_code,E=d[b].user_position;e.executeSql("INSERT INTO user (user_id , user_name , access , user_position , app_code ) VALUES ("+g+',"'+p+'",'+h+',"'+E+'",'+T+")")}for(var _=0;_<a.length;_++)for(var S=a[_],v=0;v<S.length;v++){var w=S[v].item_id,f=S[v].item_name,$=S[v].item_price,s=S[v].category_id,I=S[v].item_description;e.executeSql("INSERT INTO item (item_id, category_id, item_name, item_price, item_description) VALUES ("+w+", "+s+', "'+f+'", '+$+', "'+I+'")')}for(var x=0;x<l.length;x++){S=l[x];console.log(S);for(var y=0;y<S.length;y++){var C=S[y].VAT_number,N=S[y].service_charge,R=S[y].phone,A=S[y].message;console.log(C+" "+N+" "+R+" "+A),e.executeSql("INSERT INTO settings (VAT_number, service_charge, phone, message) VALUES ("+C+", "+N+", "+R+', "'+A+'")')}}for(var O=0;O<n.length;O++)for(var S=n[O],L=0;L<S.length;L++){var q=S[L].company_name;console.log(q),e.executeSql('UPDATE settings SET company = "'+q+'" ')}})}}})}else code.push(e);""!==(codeJoin=code.join(""))?$("#code-display").html(codeJoin):$("#code-display").html("Login code"),console.log(codeJoin)});var TableCode=[],TableCodeJoin="",TableNumber="";$("#tables").on("click","input[type=button]",function(){var e=$(this).attr("value");localStorage.setItem("table-id",e),window.location.replace("open-table.html")}),$("#top-menu").on("click","#open-table",function(){$("#enter").attr("id","open"),$("#open").val("OPEN TABLE"),""==TableCodeJoin?$("#hide").show():(console.log(TableCodeJoin),db.transaction(function(e){e.executeSql("SELECT rowid, * FROM open_table WHERE table_number = "+TableCodeJoin+" AND open = 1 ",[],function(e,t){if(1==t.rows.length){var o=TableCodeJoin;localStorage.setItem("table-id",o),window.location.replace("open-table.html")}},null)},null))}),$("#number-board-wrap").on("click","#open",function(){console.log(TableNumber),db.transaction(function(e){e.executeSql("SELECT rowid, * FROM open_table WHERE table_number = "+TableCodeJoin+" AND open = 1 ",[],function(e,t){var o=t.rows.length;if(console.log(o),1==o){var a=TableCodeJoin;localStorage.setItem("table-id",a),window.location.replace("open-table.html")}},null)},null)}),$("#top-menu").on("click","#back-button",function(){localStorage.removeItem("user_id"),window.location.replace("application.html")});var cash=0,amex=0,otherCard=0,serviceCharge=0,subtotal=0,total=0,dateTime="";$("#sum-buttons").on("click","#sum-close-day",function(){var e=localStorage.getItem("companyId");db.transaction(function(t){t.executeSql("SELECT rowid, * FROM open_table",[],function(t,o){var a,l=o.rows.length,n=0,r=0,i=0,c=0,s="",m=0,u=0,d=0,b="",p="";for(a=0;a<l;a++)n=o.rows.item(a).rowid,r=o.rows.item(a).table_number,i=o.rows.item(a).user_id,c=o.rows.item(a).customer_number,s=o.rows.item(a).payment,m=o.rows.item(a).total,u=o.rows.item(a).subtotal,d=o.rows.item(a).service_charge,b=o.rows.item(a).open_date,p="rowid="+n+"&companyId="+e+"&tableNumber="+r+"&userId="+i+"&customerNumber="+c+"&payment="+s+"&total="+m+"&subtotal="+u+"&serviceCharge="+d+"&opendate="+b,$.ajax({url:"https://gaborjuhasz.co.uk/gusto-connection/open-table.php",data:p,crossDomain:!0,type:"POST",catche:!1,success:function(e){"false"==e?alert("There was a problem with the data"):"true"==e&&alert("Table is saved to database")}}),console.log(p)}),t.executeSql("SELECT rowid, * FROM order_item",[],function(t,o){var a,l=o.rows.length,n=0,r=0,i=0,c=0,s="";for(a=0;a<l;a++)n=o.rows.item(a).rowid,r=o.rows.item(a).table_id,tableRowid=o.rows.item(a).table_rowid,i=o.rows.item(a).user_id,c=o.rows.item(a).item_id,s="rowid="+n+"&tableId="+r+"&tableRowid="+tableRowid+"&userId="+i+"&itemId="+c+"&companyId="+e,console.log(s),$.ajax({url:"https://gaborjuhasz.co.uk/gusto-connection/item.php",data:s,crossDomain:!0,type:"POST",catche:!1,success:function(e){"false"==e?alert("There was a problem"):"true"==e&&alert("Item is saved to database")}})},null)});var t=$("#customer-numbers").val(),o=$("#table-numbers").val(),a="",l="";db.transaction(function(n){n.executeSql("SELECT open_date FROM open_table WHERE rowid = 1 ",[],function(n,r){var i,c=r.rows.length;for(i=0;i<c;i++)l=r.rows.item(i).open_date,console.log(l);a="companyId="+e+"&cash="+cash+"&amex="+amex+"&other="+otherCard+"&serviceCharge="+serviceCharge+"&subtotal="+subtotal+"&total="+total+"&customers="+t+"&tableNumber="+o+"&serevedDate="+l,console.log(l),$.ajax({url:"https://gaborjuhasz.co.uk/gusto-connection/closed_day.php",data:a,crossDomain:!0,type:"POST",catche:!1,success:function(e){db.transaction(function(e){e.executeSql("DROP TABLE IF EXISTS category"),e.executeSql("DROP TABLE IF EXISTS item"),e.executeSql("DROP TABLE IF EXISTS user"),e.executeSql("DROP TABLE IF EXISTS settings"),e.executeSql("DROP TABLE IF EXISTS open_table"),e.executeSql("DROP TABLE IF EXISTS order_item"),localStorage.removeItem("user_id"),window.location.replace("index.html")})}})},null)})}),$("#top-menu").on("click","#close-day",function(){window.location.replace("sum.html")}),$("#sum-buttons").on("click","#sum-cancel",function(){window.location.replace("pos.html")}),$("#sum-buttons").on("click","#print-sum-report",function(){window.print()}),$("#top-menu").on("click","#new-table",function(){$("#open").attr("id","enter"),$("#enter").val("OPEN NEW TABLE");localStorage.getItem("user_id");$("#hide").show(),""!==TableCodeJoin?$("#text-box").html(TableCodeJoin):$("#text-box").html("Table Number")}),$("#number-board-wrap").on("click","input[type=button]",function(){TableNumber=$(this).attr("id"),console.log(TableNumber);var e=localStorage.getItem("user_id");if("back"==TableNumber)TableCode.pop();else if("cancel"==TableNumber)TableCode=[],$("#number-board-display").html(""),$("#hide").hide();else if("open"==TableNumber);else if("delete"==TableNumber)TableCode=[],$("#code-display").html("Open new table");else if("enter"==TableNumber)localStorage.setItem("table-id",TableCodeJoin),db.transaction(function(t){t.executeSql("CREATE TABLE IF NOT EXISTS open_table ( table_number INTEGER, user_id, open INTEGER, customer_number INTEGER, payment TEXT, total DECIMAL(5,2), subtotal DECIMAL(5,2), service_charge DECIMAL(5,2), open_date TEXT)"),t.executeSql("CREATE TABLE IF NOT EXISTS order_item (table_id INTEGER, table_rowid INTEGER, user_id INTEGER,item_id INTEGER, item_name TEXT, item_price DECIMAL(5,2), sent INTEGER)"),t.executeSql("SELECT * FROM open_table WHERE table_number = "+TableCodeJoin+" AND open = 1 ",[],function(t,o){var a=o.rows.length;console.log(a),0==a?(t.executeSql("INSERT INTO open_table (table_number, user_id, open) VALUES ("+TableCodeJoin+","+e+", 1)"),$("#enter").attr("id","customers"),$("#cancel").attr("id","cancel-table"),$("#enter").attr("value","customers"),$("#customers").val("CUSTOMERS"),$("#text-box").html("Customers Number"),TableCode=[]):1==a&&(TableCode=[],$("#text-box").html("Table is already open"))})});else if("customers"==TableNumber){var t=new Date,o=t.getDate(),a=t.getMonth()+1,l=t.getFullYear()+"-0"+a+"-"+o;console.log(l);n=localStorage.getItem("table-id");db.transaction(function(e){e.executeSql("UPDATE open_table SET customer_number = "+TableCodeJoin+', open_date = "'+l+'" WHERE table_number = '+n+" AND open = 1 "),console.log("Customer number: "+TableCodeJoin+" table number: "+n)}),window.location.replace("open-table.html")}else if("cancel-table"==TableNumber){var n=localStorage.getItem("table-id");console.log(n),db.transaction(function(e){e.executeSql("DELETE FROM open_table WHERE table_number = "+n+" AND open = 1 ")}),$("#customers").attr("id","enter"),$("#cancel-table").attr("id","cancel"),$("#enter").val("OPEN NEW TABLE"),$("#text-box").html("Table Number"),TableCode=[],$("#number-board-display").html(""),$("#hide").hide()}else NaN!==TableNumber&&(TableCode.push(TableNumber),console.log(TableNumber));""!==(TableCodeJoin=TableCode.join(""))?$("#text-box").html(TableCodeJoin):$("#text-box").html("Open new table")}),$("#top-menu").on("click","input[type=button]",function(){var e=$(this).attr("id"),t=localStorage.getItem("table-id");if("cancel-order"==e)db.transaction(function(e){e.executeSql("DELETE FROM order_item WHERE table_id = "+t+" AND sent = 0 "),console.log("delete")},null),localStorage.removeItem("table-id"),window.location.replace("pos.html");else{for(x=1;x<=4;x++)$("#c"+x).children().addClass("hide"),$("#c"+x).addClass("hide");$("#c"+e).removeClass("hide"),$("#c"+e).children().removeClass("hide")}}),$("#right-menu-wrap").on("click","input[type=button]",function(){var e=$(this).attr("id"),t=localStorage.getItem("table-id"),o=localStorage.getItem("user_id"),a=localStorage.getItem("table-rowid",a);db.transaction(function(l,n){l.executeSql("SELECT * FROM item WHERE item_id = "+e+" ",[],function(e,l){var n,r=l.rows.length;for(n=0;n<r;n++)var i=l.rows.item(n).item_name,c=l.rows.item(n).item_id,s=l.rows.item(n).item_price,m=0;e.executeSql("INSERT INTO order_item (table_id, table_rowid, user_id,item_id, item_name, item_price, sent) VALUES ("+t+", "+a+","+o+","+c+',"'+i+'",'+s+", 0) ",[],function(e,t){m=t.insertId,console.log(m);var o="<tr id='"+m+"'><td>1</td><td style='text-align:left;'>"+i+"</td><td style='text-align:right;'>"+s+"</td><td></td></tr>";$("#item-table  ").append(o)},null);var u=parseInt($("#service-charge-input").attr("value")),d=+parseFloat($("#subtotal-input").attr("value")).toFixed(2)+ +s,b=u/100*(d=d.toFixed(2));console.log(b);var p=b.toFixed(2),g=+p+ +d;g=g.toFixed(2),console.log("Total: "+g),$("#total-input").val(g),$("#total").html("£"+g),$("#service-charge").html("£"+p),$("#subtotal-input").val(d),$("#subtotal-price").html("£"+d)})})});var deleteItem=0;$("#item-table").on("click","tr",function(){var e=$(this).attr("id");deleteItem=e,console.log(e),$("#item-cancel").prop("disabled",!1),$("#item-table tr").css("background-color","white"),$(this).css("background-color","blue")}),$("#send-button").on("click","input[type=button]",function(){var e=$(this).attr("id"),t=localStorage.getItem("table-id"),o=(localStorage.getItem("user_id"),localStorage.getItem("table-rowid",o)),a=0,l=0;"item-cancel"==e?($("tr").remove("#"+deleteItem),db.transaction(function(e,t){e.executeSql("DELETE FROM order_item WHERE rowid = "+deleteItem+" ",[],function(e,t){console.log(t)},null)},null),db.transaction(function(e,n){e.executeSql("SELECT item_price FROM order_item WHERE table_id = "+t+" AND table_rowid = "+o+"  ",[],function(e,t){var o,n=t.rows.length,r=$("#service-charge-input").val();for(o=0;o<n;o++)l=t.rows.item(o).item_price,a+=l,console.log(a);console.log(l),$("#subtotal-price").html("£"+a.toFixed(2)),$("#subtotal-input").val(a);var i=(r/100*a).toFixed(2);$("#service-charge").html("£"+i);var c=(a+ +i).toFixed(2);$("#total").html(c),$("#total-input").val(c)},null)},null),console.log("CANCEL ITEM")):"item-send"==e?(db.transaction(function(e){e.executeSql("UPDATE order_item SET sent = 1 WHERE table_id = "+t+" AND sent = 0 "),console.log("UPDATED")},null),console.log("SEND"),localStorage.removeItem("table-id"),window.location.replace("pos.html")):"table-pay"==e&&$("#payment").show()}),$("#payment-content").on("click","input[type=button]",function(){var e=$(this).attr("id"),t=localStorage.getItem("table-id"),o=$("#total-input").val(),a=$("#subtotal-input").val(),l=(o-a).toFixed(2);console.log(a+", "+l),db.transaction(function(n){"cancel"==e?$("#payment").hide():(console.log(e),n.executeSql('UPDATE open_table SET open = 0, payment = "'+e+'", total = '+o+", subtotal = "+a+", service_charge = "+l+"  WHERE table_number = "+t+" AND open = 1 "),console.log("PAY"),localStorage.removeItem("table-id"),window.location.replace("pos.html"))},null)}),$("#send-button").on("click","#print",function(){document.getElementById("items");window.print()});